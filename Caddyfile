# Caddyfile para deploy do projeto NeuroCP
# Substitua "seudominio.com" pelo seu domínio real

seudominio.com {
    # Diretório onde estão os arquivos do build
    root * /var/www/neurocp/dist
    
    # Servir arquivos estáticos
    file_server
    
    # SPA routing - redireciona todas as rotas não encontradas para index.html
    try_files {path} /index.html
    
    # Compressão gzip para melhor performance
    encode gzip
    
    # Headers de segurança
    header {
        # Previne clickjacking
        X-Frame-Options "DENY"
        # Previne XSS
        X-Content-Type-Options "nosniff"
        # Força HTTPS
        Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
        # CSP básico
        Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:;"
    }
    
    # Cache para assets estáticos (JS, CSS, imagens)
    @static {
        path *.js *.css *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2 *.ttf *.eot
    }
    header @static {
        Cache-Control "public, max-age=31536000, immutable"
    }
    
    # Cache menor para HTML
    @html {
        path *.html
    }
    header @html {
        Cache-Control "public, max-age=300"
    }
    
    # Log de acesso (opcional)
    log {
        output file /var/log/caddy/neurocp.log
        format json
    }
}

# Opcional: Redirecionamento de www para não-www
www.seudominio.com {
    redir https://seudominio.com{uri} permanent
}